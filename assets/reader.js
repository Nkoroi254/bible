(function(){if(typeof android==="undefined"){android={setVerse:function(x){console.log("android.setVerse: "+x)},setCopyText:function(x){console.log("android.setCopyText: "+x)},setHighlighted:function(x){console.log("android.setHighlighted: "+x)},showAnnotation:function(x){console.log("android.showAnnotation: "+x)},showNote:function(x){console.log("android.showNote: "+x)}}}var a,t,q,c={setup:function(y,x){this.cancel();this.timeoutID=window.setTimeout(function(z){z()},x,y)},cancel:function(){if(typeof this.timeoutID=="number"){window.clearTimeout(this.timeoutID);delete this.timeoutID}}};function v(B,A,x,D){var C=B.querySelectorAll(x);A=A||[];for(var z=0;z<C.length;++z){var y=C.item(z);if(!D||b(y,D,false)){A.push(y)}}}function w(y){var x=[];y=y||document;v(y,x,".chapternum");v(y,x,"sup.versenum");v(y,x,"sup",t);return x}function r(){var y,A,x=NaN,C;C=w();for(var B=0;B<C.length;B++){var z=Math.round(C[B].getBoundingClientRect().top);if(z>=0){if(isNaN(x)||Math.abs(x)>3*z){y=C[B]}else{y=C[B-1]}break}else{x=z}}if(y){android.setVerse(y.textContent.split("-")[0].trim())}}if(typeof String.prototype.endsWith!=="function"){String.prototype.endsWith=function(x){return this.indexOf(x,this.length-x.length)!==-1}}function j(A){var C="",K="",G,y,x,F,J="",L=NaN;y=document.createElement("div");x=document.querySelectorAll(A);for(var B=0;B<x.length;B++){C+=" "+x.item(B).innerHTML}y.innerHTML=C;F=w(y);for(var B=0;B<F.length;B++){var H=NaN,z=NaN,E;if(b(F[B],"chapternum")){E="1"}else{E=F[B].textContent.trim().split("-")}H=parseInt(E[0].trim());if(isNaN(H)){continue}F[B].parentNode.removeChild(F[B]);if(E.length>1){z=parseInt(E[1].trim())}if(!z||isNaN(z)){z=H}for(var I=H;I<=z;++I){if(isNaN(L)){J+=I}else{if(I==L){}else{if(I-L==1){if(!J.endsWith("-")){J+="-"}}else{if(J.endsWith("-")){J+=L}J+=",";J+=I}}}L=I}}if(J.endsWith("-")&&!isNaN(L)){J+=L}function D(M){var N=y.querySelectorAll(M);for(var O=0;O<N.length;++O){y.removeChild(N[O])}}D(".notelink");D(".footnote");D(".crossreference");K=y.textContent.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"").trim();return{verse:J,text:K}}function u(){var x=j(".selected");if(x.text){var y=document.querySelectorAll(".highlight.selected").length;android.setCopyText(""+y+"\n"+x.verse+"\n"+x.text)}else{android.setCopyText("")}}function h(x){var y=x.className,z;if(b(x,"selected")){z=false}else{z=true}y.match(/\S+/g).forEach(function(D){if(t&&D.indexOf(t)!=-1){var C=document.getElementsByClassName(D);for(var B=C.length-1;B>-1;--B){var A=C.item(B);if(A.nodeName=="SUP"){continue}if(!z){p(A,"selected")}else{if(!b(A,"selected")){o(A,"selected")}}}}});c.setup(u,250)}function i(C){var y="",x,z,D;if(!C){return false}x=document.body.innerHTML;z=x.toLowerCase();D=C.toLowerCase();while(x.length>0){var B=C,A=z.indexOf(D);if(A<0){break}if(x.lastIndexOf(">",A)>=x.lastIndexOf("<",A)){B='<span class="selected">'+C+"</span>"}y+=x.substring(0,A)+B;x=x.substr(A+C.length);z=z.substr(A+C.length)}y+=x;document.body.innerHTML=y;return true}function l(){var y;s();if(verse_start>1){var x=k(verse_start);if(x.length>0){x[0].scrollIntoView()}}i(search);if(highlighted){e(highlighted)}if(selected){d(selected)}if(notes){notes.forEach(function(z){addnote(z)})}n();y=document.querySelector("#pb-demo");if(y){y.style.display="block"}}function g(A){var z;if(A==undefined){A="highlight"}else{A=A.trim()}z=document.getElementsByClassName(A);for(var y=z.length-1;y>-1;--y){var x=z.item(y);if(x.className.trim()==A&&x.childNodes.length==1&&x.firstChild.nodeType==3){x.parentNode.replaceChild(x.firstChild,x)}else{p(x,A)}}search="";document.normalize()}function n(){document.querySelector("#content").addEventListener("click",function(A){var y=A.target;while(y&&y.nodeName!="BODY"){if(y.nodeName=="IMG"){var x=y.getAttribute("data-note");if(x){A.preventDefault();android.showNote(x);return}}if(y.nodeName=="A"&&(b(y,"notelink")||(y.parentNode&&y.parentNode.nodeName=="SUP"))){var z=y.hash.replace("#","");if(z){A.preventDefault();android.showAnnotation(z);return}}if(y.nodeName=="SPAN"&&(b(y,"text")||b(y,t,false))){if(search){g("selected")}h(y);break}y=y.parentNode}})}function k(A){var x=t+q+A,E=document.getElementsByClassName(x);if(E.length){return E}if(x[0]=="v"){var D=["a","b","c"];for(var z in D){E=document.getElementsByClassName(x+D[z]);if(E.length){break}}}else{var B,y,C=new RegExp("(?:^|\\s)"+x+"-\\S+");if(!a){a=document.querySelectorAll(".text")}for(B=0;B<a.length;++B){y=a.item(B).className.match(C);if(y){break}}if(B!=a.length){E=document.getElementsByClassName(y[0])}}if(E.length||A<2){return E}else{return k(A-1)}}function f(y,x,B){var C;if(!y){return}C=k(y);for(var A=C.length-1;A>-1;--A){var z=C.item(A);if(z.nodeName=="SUP"){continue}if(x===false){p(z,B)}else{o(z,B)}}}function o(y,x){if(!y){}else{if(!y.className){y.className=x}else{if(!b(y,x)){y.className+=" "+x}}}}function b(A,z,x){var y;if(!A.className){return false}else{if(x===false){y=new RegExp("(?:^|\\s)"+z)}else{y=new RegExp("(?:^|\\s)"+z+"(?!\\S)")}}return A.className.match(y)!=null}function p(z,y){if(!z||!z.className){}else{var x=new RegExp("(?:^|\\s)"+y+"(?!\\S)");if(z.className.match(x)){z.className=z.className.replace(x,"").trim()}}}function s(){if(t!=undefined&&q!=undefined){return}try{q="-";t=document.querySelector(".text").className.replace(/\s*text\s*/g,"").split(q).splice(0,2).join(q)}catch(x){}try{if(!t||t.indexOf(q)==-1){q="_";t=document.querySelector("sup").className.split(q).splice(0,2).join(q);if(!t||t.indexOf(q)==-1){t="";q=""}}}catch(x){}}function e(z,x,y){s();if(!t){return}if(y===undefined){y="highlight"}z.split(",").forEach(function(C){var D=C.split("-"),B=parseInt(D[0]);if(D.length==2){var A=parseInt(D[1]);for(;B<=A;++B){f(B,x,y)}}else{f(B,x,y)}});if(y=="highlight"){android.setHighlighted(j(".highlight").verse)}}function d(y,x){e(y,x,"selected")}function m(z,x){var B,C=k(z);if(!C.length){return}for(var A=0;A<C.length;++A){B=C[A];if(B.firstChild&&B.firstChild.nextSibling){if(x===false&&B.firstChild.nextSibling.nodeName=="IMG"){B.removeChild(B.firstChild.nextSibling)}else{if(x!==false&&B.firstChild.nextSibling.nodeName!="IMG"){var y=document.createElement("img");y.setAttribute("class","note");y.setAttribute("data-note",z);y.setAttribute("src","note.png");B.insertBefore(y,B.firstChild.nextSibling)}}return}}}window.addEventListener("load",l);window.getFirstVisibleVerse=r;window.highlight=e;window.select=d;window.addnote=m})();