(function(){if(typeof android==="undefined"){android={setVerse:function(r){console.log("android.setVerse: "+r)},setCopyText:function(r){console.log("android.setCopyText: "+r)},setHighlighted:function(r){console.log("android.setHighlighted: "+r)}}}function a(){var s="",r=NaN,v;v=document.querySelectorAll(".pb-verse");for(var u=0;u<v.length;u++){var t=Math.round(v[u].getBoundingClientRect().top);if(t>=0){if(isNaN(r)||Math.abs(r)>3*t){s=v[u].getAttribute("title")}else{s=v[u-1].getAttribute("title")}break}else{r=t}}android.setVerse(s)}if(typeof String.prototype.endsWith!=="function"){String.prototype.endsWith=function(r){return this.indexOf(r,this.length-r.length)!==-1}}function d(v){var s="",z="",t,y,u,x="",A=NaN;y=document.createElement("span");u=document.querySelectorAll("."+v);for(var r=0;r<u.length;r++){s+=" "+u.item(r).innerHTML}t=s.replace(new RegExp('<span class="pb-verse.*?</span>',"gi"),"");y.innerHTML=s;u=y.querySelectorAll(".pb-verse");for(var r=0;r<u.length;r++){var w=parseInt(u.item(r).getAttribute("title"));if(isNaN(w)){continue}if(isNaN(A)){x+=w}else{if(w-A==1){if(!x.endsWith("-")){x+="-"}}else{if(x.endsWith("-")){x+=A}x+=",";x+=w}}A=w}if(x.endsWith("-")&&!isNaN(A)){x+=A}y.innerHTML=t;z=y.textContent.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");return{verse:x,text:z}}function q(){var r=d("selected");if(r.text){var s=document.querySelectorAll(".highlight.selected").length;android.setCopyText(""+s+"\n"+r.verse+"\n"+r.text)}else{android.setCopyText("")}}function p(r){var s=r.className,t;if(i(r,"selected")){t=false}else{t=true}s.match(/\S+/g).forEach(function(x){if(j&&x.indexOf(j)!=-1){var w=document.querySelectorAll("."+x);for(var v=0;v<w.length;++v){var u=w.item(v);if(u.nodeName=="STRONG"){continue}if(!t){n(u,"selected")}else{if(!i(u,"selected")){k(u,"selected")}}}}});c.setup(q,250)}function g(w){var s="",r,t,x;if(!w){return false}r=document.body.innerHTML;t=r.toLowerCase();x=w.toLowerCase();while(r.length>0){var v=w;var u=t.indexOf(x);if(u<0){break}if(r.lastIndexOf(">",u)>=r.lastIndexOf("<",u)){v='<span class="highlight">'+w+"</span>"}s+=r.substring(0,u)+v;r=r.substr(u+w.length);t=t.substr(u+w.length)}s+=r;document.body.innerHTML=s;return true}function o(){if(verse_start>1){window.location.hash="#"+versename+"-"+verse_start}h();g(search);if(highlighted){l(highlighted)}b();var r=document.querySelector("#pb-demo");if(r){r.style.display="block"}}function m(u){var t;if(u==undefined){u="highlight"}else{u=u.trim()}t=document.querySelectorAll("."+u);for(var s=0;s<t.length;++s){var r=t.item(s);if(r.className.trim()==u&&r.childNodes.length==1&&r.firstChild.nodeType==3){r.parentNode.replaceChild(r.firstChild,r)}else{n(r,u)}}search="";document.normalize()}function b(){document.querySelector("#content").addEventListener("click",function(s){var r=s.target;while(r&&r.nodeName!="BODY"){if(r.nodeName=="SPAN"&&(i(r,"text")||i(r,j,false))){if(search){m()}p(r);break}r=r.parentNode}})}var c={setup:function(s,r){this.cancel();this.timeoutID=window.setTimeout(function(t){t()},r,s)},cancel:function(){if(typeof this.timeoutID=="number"){window.clearTimeout(this.timeoutID);delete this.timeoutID}}};function e(s,r){var v=document.querySelectorAll("."+s);if(!v){return}for(var u=0;u<v.length;++u){var t=v.item(u);if(t.nodeName=="STRONG"){continue}n(t,"selected");if(r===false){n(t,"highlight")}else{k(t,"highlight")}}}function k(s,r){if(!s){}else{if(!s.className){s.className=r}else{if(!i(s,r)){s.className+=" "+r}}}}function i(u,t,r){var s;if(!u.className){return false}else{if(r===false){s=new RegExp("(?:^|\\s)"+t)}else{s=new RegExp("(?:^|\\s)"+t+"(?!\\S)")}}return u.className.match(s)!=null}function n(t,s){if(!t||!t.className){}else{var r=new RegExp("(?:^|\\s)"+s+"(?!\\S)");if(t.className.match(r)){t.className=t.className.replace(r,"").trim()}}}var j,f;function h(){if(j!=undefined&&f!=undefined){return}try{f="_";j=document.querySelector("sup").querySelector("strong").className.split("_").splice(0,2).join("_")}catch(r){}try{if(!j||j.indexOf("_")==-1){f="-";j=document.querySelector(".text").className.replace(/\s*text\s*/g,"").split("-").splice(0,2).join("-");if(!j||j.indexOf("-")==-1){j="";f=""}}}catch(r){}}function l(s,r){h();if(!j){return}s.split(",").forEach(function(u){var v=u.split("-");var w=parseInt(v[0]);if(v.length==2){var t=parseInt(v[1]);for(;w<=t;++w){e(j+f+w,r)}}else{e(j+f+w,r)}});var s=d("highlight");android.setHighlighted(s.verse)}window.addEventListener("load",o);window.getFirstVisibleVerse=a;window.highlight=l})();