(function(){if(typeof android==="undefined"){android={setVerse:function(r){console.log("android.setVerse: "+r)},setCopyText:function(r){console.log("android.setCopyText: "+r)},setHighlighted:function(r){console.log("android.setHighlighted: "+r)}}}var e,h,q={setup:function(s,r){this.cancel();this.timeoutID=window.setTimeout(function(t){t()},r,s)},cancel:function(){if(typeof this.timeoutID=="number"){window.clearTimeout(this.timeoutID);delete this.timeoutID}}};function i(){var r="",v=NaN,u;u=document.querySelectorAll(".pb-verse");for(var t=0;t<u.length;t++){var s=Math.round(u[t].getBoundingClientRect().top);if(s>=0){if(isNaN(v)||Math.abs(v)>3*s){r=u[t].getAttribute("title")}else{r=u[t-1].getAttribute("title")}break}else{v=s}}android.setVerse(r)}if(typeof String.prototype.endsWith!=="function"){String.prototype.endsWith=function(r){return this.indexOf(r,this.length-r.length)!==-1}}function a(t){var A="",x="",r,w,s,v="",y=NaN;w=document.createElement("span");s=document.querySelectorAll(t);for(var z=0;z<s.length;z++){A+=" "+s.item(z).innerHTML}r=A.replace(new RegExp('<span class="pb-verse.*?</span>',"gi"),"");w.innerHTML=A;s=w.querySelectorAll(".pb-verse");for(var z=0;z<s.length;z++){var u=parseInt(s.item(z).getAttribute("title"));if(isNaN(u)){continue}if(isNaN(y)){v+=u}else{if(u-y==1){if(!v.endsWith("-")){v+="-"}}else{if(v.endsWith("-")){v+=y}v+=",";v+=u}}y=u}if(v.endsWith("-")&&!isNaN(y)){v+=y}w.innerHTML=r;x=w.textContent.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");return{verse:v,text:x}}function j(){var r=a(".selected");if(r.text){var s=document.querySelectorAll(".highlight.selected").length;android.setCopyText(""+s+"\n"+r.verse+"\n"+r.text)}else{android.setCopyText("")}}function d(s){var t=s.className,r;if(b(s,"selected")){r=false}else{r=true}t.match(/\S+/g).forEach(function(x){if(e&&x.indexOf(e)!=-1){var w=document.getElementsByClassName(x);for(var v=0;v<w.length;++v){var u=w.item(v);if(u.nodeName=="STRONG"){continue}if(!r){I(u,"selected")}else{if(!b(u,"selected")){g(u,"selected")}}}}});q.setup(j,250)}function l(t){var w="",v,x,u;if(!t){return false}v=document.body.innerHTML;x=v.toLowerCase();u=t.toLowerCase();while(v.length>0){var s=t,r=x.indexOf(u);if(r<0){break}if(v.lastIndexOf(">",r)>=v.lastIndexOf("<",r)){s='<span class="highlight">'+t+"</span>"}w+=v.substring(0,r)+s;v=v.substr(r+t.length);x=x.substr(r+t.length)}w+=v;document.body.innerHTML=w;return true}function c(){var r;if(verse_start>1){window.location.hash="#"+versename+"-"+verse_start}m();l(search);if(highlighted){k(highlighted)}n();r=document.querySelector("#pb-demo");if(r){r.style.display="block"}}function p(u){var t;if(u==undefined){u="highlight"}else{u=u.trim()}t=document.getElementsByClassName(u);for(var s=t.length-1;s>-1;++s){var r=t.item(s);if(r.className.trim()==u&&r.childNodes.length==1&&r.firstChild.nodeType==3){r.parentNode.replaceChild(r.firstChild,r)}else{I(r,u)}}search="";document.normalize()}function n(){document.querySelector("#content").addEventListener("click",function(s){var r=s.target;while(r&&r.nodeName!="BODY"){if(r.nodeName=="SPAN"&&(b(r,"text")||b(r,e,false))){if(search){p()}d(r);break}r=r.parentNode}})}function f(s,z,v){var y=document.getElementsByClassName(s);if(!y.length){var w,r=new RegExp("(?:^|\\s)"+s+"\\S+");y=document.querySelectorAll(".text");for(var t=0;t<y.length+1;++t){if(t==y.length){return}w=y.item(t).className.match(r);if(w){break}}y=document.getElementsByClassName(w[0]);if(!y.length){return}}for(var x=y.length-1;x>-1;--x){var u=y.item(x);if(u.nodeName=="STRONG"){continue}if(z===false){I(u,v)}else{g(u,v)}}}function g(s,r){if(!s){}else{if(!s.className){s.className=r}else{if(!b(s,r)){s.className+=" "+r}}}}function b(u,t,r){var s;if(!u.className){return false}else{if(r===false){s=new RegExp("(?:^|\\s)"+t)}else{s=new RegExp("(?:^|\\s)"+t+"(?!\\S)")}}return u.className.match(s)!=null}function I(r,t){if(!r||!r.className){}else{var s=new RegExp("(?:^|\\s)"+t+"(?!\\S)");if(r.className.match(s)){r.className=r.className.replace(s,"").trim()}}}function m(){if(e!=undefined&&h!=undefined){return}try{h="_";e=document.querySelector("sup").querySelector("strong").className.split("_").splice(0,2).join("_")}catch(r){}try{if(!e||e.indexOf("_")==-1){h="-";e=document.querySelector(".text").className.replace(/\s*text\s*/g,"").split("-").splice(0,2).join("-");if(!e||e.indexOf("-")==-1){e="";h=""}}}catch(r){}}function k(r,t,s){m();if(!e){return}if(s===undefined){s="highlight"}r.split(",").forEach(function(v){var w=v.split("-");var x=parseInt(w[0]);if(w.length==2){var u=parseInt(w[1]);for(;x<=u;++x){f(e+h+x,t,s)}}else{f(e+h+x,t,s)}});if(s=="highlight"){android.setHighlighted(a(".highlight").verse)}}function o(s,r){k(s,r,"selected")}window.addEventListener("load",c);window.getFirstVisibleVerse=i;window.highlight=k;window.select=o})();