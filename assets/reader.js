(function(){if(typeof android==="undefined"){android={setVerse:function(w){console.log("android.setVerse: "+w)},setCopyText:function(w){console.log("android.setCopyText: "+w)},setHighlighted:function(w){console.log("android.setHighlighted: "+w)},showAnnotation:function(w){console.log("android.showAnnotation: "+w)}}}var a,s,p,c={setup:function(x,w){this.cancel();this.timeoutID=window.setTimeout(function(y){y()},w,x)},cancel:function(){if(typeof this.timeoutID=="number"){window.clearTimeout(this.timeoutID);delete this.timeoutID}}};function u(A,z,w,C){var B=A.querySelectorAll(w);z=z||[];for(var y=0;y<B.length;++y){var x=B.item(y);if(!C||b(x,C,false)){z.push(x)}}}function v(x){var w=[];x=x||document;u(x,w,".chapternum");u(x,w,"sup.versenum");u(x,w,"sup",s);return w}function q(){var x,z,w=NaN,B;B=v();for(var A=0;A<B.length;A++){var y=Math.round(B[A].getBoundingClientRect().top);if(y>=0){if(isNaN(w)||Math.abs(w)>3*y){x=B[A]}else{x=B[A-1]}break}else{w=y}}if(x){android.setVerse(x.textContent.split("-")[0].trim())}}if(typeof String.prototype.endsWith!=="function"){String.prototype.endsWith=function(w){return this.indexOf(w,this.length-w.length)!==-1}}function j(z){var B="",J="",F,x,w,E,I="",K=NaN;x=document.createElement("div");w=document.querySelectorAll(z);for(var A=0;A<w.length;A++){B+=" "+w.item(A).innerHTML}x.innerHTML=B;E=v(x);for(var A=0;A<E.length;A++){var G=NaN,y=NaN,D;if(b(E[A],"chapternum")){D="1"}else{D=E[A].textContent.trim().split("-")}G=parseInt(D[0].trim());if(isNaN(G)){continue}E[A].parentNode.removeChild(E[A]);if(D.length>1){y=parseInt(D[1].trim())}if(!y||isNaN(y)){y=G}for(var H=G;H<=y;++H){if(isNaN(K)){I+=H}else{if(H==K){}else{if(H-K==1){if(!I.endsWith("-")){I+="-"}}else{if(I.endsWith("-")){I+=K}I+=",";I+=H}}}K=H}}if(I.endsWith("-")&&!isNaN(K)){I+=K}function C(L){var M=x.querySelectorAll(L);for(var N=0;N<M.length;++N){x.removeChild(M[N])}}C(".notelink");C(".footnote");C(".crossreference");J=x.textContent.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"").trim();return{verse:I,text:J}}function t(){var w=j(".selected");if(w.text){var x=document.querySelectorAll(".highlight.selected").length;android.setCopyText(""+x+"\n"+w.verse+"\n"+w.text)}else{android.setCopyText("")}}function h(w){var x=w.className,y;if(b(w,"selected")){y=false}else{y=true}x.match(/\S+/g).forEach(function(C){if(s&&C.indexOf(s)!=-1){var B=document.getElementsByClassName(C);for(var A=B.length-1;A>-1;--A){var z=B.item(A);if(z.nodeName=="SUP"){continue}if(!y){o(z,"selected")}else{if(!b(z,"selected")){n(z,"selected")}}}}});c.setup(t,250)}function i(B){var x="",w,y,C;if(!B){return false}w=document.body.innerHTML;y=w.toLowerCase();C=B.toLowerCase();while(w.length>0){var A=B,z=y.indexOf(C);if(z<0){break}if(w.lastIndexOf(">",z)>=w.lastIndexOf("<",z)){A='<span class="selected">'+B+"</span>"}x+=w.substring(0,z)+A;w=w.substr(z+B.length);y=y.substr(z+B.length)}x+=w;document.body.innerHTML=x;return true}function l(){var x;r();if(verse_start>1){var w=k(verse_start);if(w.length>0){w[0].scrollIntoView()}}i(search);if(highlighted){e(highlighted)}if(selected){d(selected)}m();x=document.querySelector("#pb-demo");if(x){x.style.display="block"}}function g(z){var y;if(z==undefined){z="highlight"}else{z=z.trim()}y=document.getElementsByClassName(z);for(var x=y.length-1;x>-1;--x){var w=y.item(x);if(w.className.trim()==z&&w.childNodes.length==1&&w.firstChild.nodeType==3){w.parentNode.replaceChild(w.firstChild,w)}else{o(w,z)}}search="";document.normalize()}function m(){document.querySelector("#content").addEventListener("click",function(y){var w=y.target;while(w&&w.nodeName!="BODY"){if(w.nodeName=="A"&&(b(w,"notelink")||(w.parentNode&&w.parentNode.nodeName=="SUP"))){var x=w.hash.replace("#","");if(x){y.preventDefault();android.showAnnotation(x);break}}if(w.nodeName=="SPAN"&&(b(w,"text")||b(w,s,false))){if(search){g("selected")}h(w);break}w=w.parentNode}})}function k(z){var w=s+p+z,D=document.getElementsByClassName(w);if(D.length){return D}if(w[0]=="v"){var C=["a","b","c"];for(var y in C){D=document.getElementsByClassName(w+C[y]);if(D.length){break}}}else{var A,x,B=new RegExp("(?:^|\\s)"+w+"-\\S+");if(!a){a=document.querySelectorAll(".text")}for(A=0;A<a.length;++A){x=a.item(A).className.match(B);if(x){break}}if(A!=a.length){D=document.getElementsByClassName(x[0])}}if(D.length||z<2){return D}else{return k(z-1)}}function f(x,w,A){var B;if(!x){return}B=k(x);for(var z=B.length-1;z>-1;--z){var y=B.item(z);if(y.nodeName=="SUP"){continue}if(w===false){o(y,A)}else{n(y,A)}}}function n(x,w){if(!x){}else{if(!x.className){x.className=w}else{if(!b(x,w)){x.className+=" "+w}}}}function b(z,y,w){var x;if(!z.className){return false}else{if(w===false){x=new RegExp("(?:^|\\s)"+y)}else{x=new RegExp("(?:^|\\s)"+y+"(?!\\S)")}}return z.className.match(x)!=null}function o(y,x){if(!y||!y.className){}else{var w=new RegExp("(?:^|\\s)"+x+"(?!\\S)");if(y.className.match(w)){y.className=y.className.replace(w,"").trim()}}}function r(){if(s!=undefined&&p!=undefined){return}try{p="-";s=document.querySelector(".text").className.replace(/\s*text\s*/g,"").split(p).splice(0,2).join(p)}catch(w){}try{if(!s||s.indexOf(p)==-1){p="_";s=document.querySelector("sup").className.split(p).splice(0,2).join(p);if(!s||s.indexOf(p)==-1){s="";p=""}}}catch(w){}}function e(y,w,x){r();if(!s){return}if(x===undefined){x="highlight"}y.split(",").forEach(function(B){var C=B.split("-"),A=parseInt(C[0]);if(C.length==2){var z=parseInt(C[1]);for(;A<=z;++A){f(A,w,x)}}else{f(A,w,x)}});if(x=="highlight"){android.setHighlighted(j(".highlight").verse)}}function d(x,w){e(x,w,"selected")}window.addEventListener("load",l);window.getFirstVisibleVerse=q;window.highlight=e;window.select=d})();