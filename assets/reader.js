(function(){if(typeof android==="undefined"){android={setVerse:function(v){console.log("android.setVerse: "+v)},setCopyText:function(v){console.log("android.setCopyText: "+v)},setHighlighted:function(v){console.log("android.setHighlighted: "+v)},showAnnotation:function(v){console.log("android.showAnnotation: "+v)},showNote:function(v){console.log("android.showNote: "+v)}}}var a,s,p;function u(w){var v=[];w=w||document;function x(C,B,y,E){var D=C.querySelectorAll(y);for(var A=0;A<D.length;++A){var z=D.item(A);if(!E||b(z,E,false)){B.push(z)}}}x(w,v,".chapternum");x(w,v,"sup.versenum");if(v.length==0){x(w,v,"sup",s)}return v}function q(){var w,y,v=NaN,A;A=u();for(var z=0;z<A.length;z++){var x=Math.round(A[z].getBoundingClientRect().top);if(x>=0){if(isNaN(v)||Math.abs(v)>3*x){w=A[z]}else{w=A[z-1]}break}else{v=x}}if(w){android.setVerse(w.textContent.split("-")[0].trim())}}if(typeof String.prototype.endsWith!=="function"){String.prototype.endsWith=function(v){return this.indexOf(v,this.length-v.length)!==-1}}function i(y){var A="",I="",E,w,v,D,H="",J=NaN;w=document.createElement("div");v=document.querySelectorAll(y);for(var z=0;z<v.length;z++){A+=" "+v.item(z).innerHTML}w.innerHTML=A;D=u(w);for(var z=0;z<D.length;z++){var F=NaN,x=NaN,C;if(b(D[z],"chapternum")){C="1"}else{C=D[z].textContent.trim().split("-")}F=parseInt(C[0].trim());if(isNaN(F)){continue}D[z].parentNode.removeChild(D[z]);if(C.length>1){x=parseInt(C[1].trim())}if(!x||isNaN(x)){x=F}for(var G=F;G<=x;++G){if(isNaN(J)){H+=G}else{if(G==J){}else{if(G-J==1){if(!H.endsWith("-")){H+="-"}}else{if(H.endsWith("-")){H+=J}H+=",";H+=G}}}J=G}}if(H.endsWith("-")&&!isNaN(J)){H+=J}function B(K){var L=w.querySelectorAll(K);for(var M=0;M<L.length;++M){L[M].parentNode.removeChild(L[M])}}B(".notelink");B(".footnote");B(".crossreference");I=w.textContent.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"").trim();return{verse:H,text:I}}function t(){var v=i(".selected");if(v.text){var w=document.querySelectorAll(".highlight.selected").length;android.setCopyText(""+w+"\n"+v.verse+"\n"+v.text)}else{android.setCopyText("")}}function g(v){var w=v.className,x;if(b(v,"selected")){x=false}else{x=true}w.match(/\S+/g).forEach(function(B){if(s&&B.indexOf(s)!=-1){var A=document.getElementsByClassName(B);for(var z=A.length-1;z>-1;--z){var y=A.item(z);if(y.nodeName=="SUP"){continue}if(!x){o(y,"selected")}else{n(y,"selected")}}}});t()}function h(A){var w="",v,x,B;if(!A){return false}v=document.body.innerHTML;x=v.toLowerCase();B=A.toLowerCase();while(v.length>0){var z=A,y=x.indexOf(B);if(y<0){break}if(v.lastIndexOf(">",y)>=v.lastIndexOf("<",y)){z='<span class="selected">'+A+"</span>"}w+=v.substring(0,y)+z;v=v.substr(y+A.length);x=x.substr(y+A.length)}w+=v;document.body.innerHTML=w;return true}function k(){var w;console.log(new Date());r();if(verse_start>1){var v=j(verse_start);if(v.length>0){v[0].scrollIntoView()}}h(search);if(highlighted){d(highlighted)}if(selected){c(selected)}if(notes){notes.forEach(function(x){addnote(x)})}m();w=document.querySelector("#pb-demo");if(w){w.style.display="block"}}function f(y){var x;if(y==undefined){y="highlight"}else{y=y.trim()}x=document.getElementsByClassName(y);for(var w=x.length-1;w>-1;--w){var v=x.item(w);if(v.className.trim()==y&&v.childNodes.length==1&&v.firstChild.nodeType==3){v.parentNode.replaceChild(v.firstChild,v)}else{o(v,y)}}search="";document.normalize()}function m(){document.querySelector("#content").addEventListener("click",function(y){var w=y.target;while(w&&w.nodeName!="BODY"){if(w.nodeName=="IMG"){var v=w.getAttribute("data-note");if(v){y.preventDefault();android.showNote(v);return}}else{if(w.nodeName=="A"&&(b(w,"notelink")||(w.parentNode&&w.parentNode.nodeName=="SUP"))){var x=w.hash.replace("#","");if(x){y.preventDefault();android.showAnnotation(x);return}}else{if(w.nodeName=="SPAN"&&(b(w,"text")||b(w,s,false))){if(search){f("selected")}g(w);break}}}w=w.parentNode}})}function j(y){var v=s+p+y,C=document.getElementsByClassName(v);if(C.length){return C}if(v[0]=="v"){var B=["a","b","c"];for(var x in B){C=document.getElementsByClassName(v+B[x]);if(C.length){break}}}else{var z,w,A=new RegExp("(?:^|\\s)"+v+"-\\S+");if(!a){a=document.querySelectorAll(".text")}for(z=0;z<a.length;++z){w=a.item(z).className.match(A);if(w){break}}if(z!=a.length){C=document.getElementsByClassName(w[0])}}if(C.length||y<2){return C}else{return j(y-1)}}function e(w,v,z){var A;if(!w){return}A=j(w);for(var y=A.length-1;y>-1;--y){var x=A.item(y);if(x.nodeName=="SUP"){continue}if(v===false){o(x,z)}else{n(x,z)}}}function n(w,v){if(!w){}else{if(!w.className){w.className=v}else{if(!b(w,v)){w.className+=" "+v}}}}function b(y,x,v){var w;if(!y||!y.className){return false}else{if(v===false){w=new RegExp("(?:^|\\s)"+x)}else{w=new RegExp("(?:^|\\s)"+x+"(?!\\S)")}}return y.className.match(w)!=null}function o(x,w){if(!x||!x.className){}else{var v=new RegExp("(?:^|\\s)"+w+"(?!\\S)");if(x.className.match(v)){x.className=x.className.replace(v,"").trim()}}}function r(){if(s!=undefined&&p!=undefined){return}try{p="-";s=document.querySelector(".text").className.replace(/\s*text\s*/g,"").split(p).splice(0,2).join(p)}catch(v){}try{if(!s||s.indexOf(p)==-1){p="_";s=document.querySelector("sup").className.split(p).splice(0,2).join(p);if(!s||s.indexOf(p)==-1){s="";p=""}}}catch(v){}}function d(x,v,w){r();if(!s){return}if(w===undefined){w="highlight"}x.split(",").forEach(function(A){var B=A.split("-"),z=parseInt(B[0]);if(B.length==2){var y=parseInt(B[1]);for(;z<=y;++z){e(z,v,w)}}else{e(z,v,w)}});if(w=="highlight"){android.setHighlighted(i(".highlight").verse)}}function c(w,v){d(w,v,"selected")}function l(x,v){var z,A=j(x);if(!A.length){return}for(var y=0;y<A.length;++y){z=A[y];if(z.firstChild&&z.firstChild.nextSibling){if(v===false&&z.firstChild.nextSibling.nodeName=="IMG"){z.removeChild(z.firstChild.nextSibling)}else{if(v!==false&&z.firstChild.nextSibling.nodeName!="IMG"){var w=document.createElement("img");w.setAttribute("class","note");w.setAttribute("data-note",x);w.setAttribute("src","note.png");z.insertBefore(w,z.firstChild.nextSibling)}}return}}}window.addEventListener("load",k);window.addEventListener("DOMContentLoaded",function(v){console.log("DOMContentLoaded: "+new Date())});window.getFirstVisibleVerse=q;window.highlight=d;window.select=c;window.addnote=l})();